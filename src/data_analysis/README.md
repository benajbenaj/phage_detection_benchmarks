# Data Analysis Scripts

All R scripts should should be run from the root of this project, since that is where the `.Rproj` file and `renv/` are located. To call the scripts shown below, prepend with `src/data_analysis/`

# Classified Chopped Genomes

## Scripts

### `extract_ids.R`

Input: file generated by running `grep -r ">" data/refseq/*/*.fna > data/chopped/ids.txt`
Output: `{outdir}/extracted_ids.csv`

Parses the grep output to extract the assembly accession id from the file names and sequence ids inside those files.

Help message:
```
$ ./extract_ids.R -h

usage: src/data_analysis/extract_ids.R [-h] [-o OUTDIR] FILE

Extract Assembly Accession and Record IDs

positional arguments:
  FILE                  File resulting from grep '>' on genome files

optional arguments:
  -h, --help            show this help message and exit
  -o OUTDIR, --outdir OUTDIR
                        Output directory
```

Usage example
```
$ head -n data/chopped/ids.txt
archaea/GCF_000006175.1_ASM617v2_genomic.fna:>NC_014222.1 Methanococcus voltae A3, complete sequence
archaea/GCF_000006805.1_ASM680v1_genomic.fna:>NC_002607.1 Halobacterium salinarum NRC-1, complete sequence
archaea/GCF_000006805.1_ASM680v1_genomic.fna:>NC_001869.1 Halobacterium salinarum NRC-1 plasmid pNRC100, complete sequence
archaea/GCF_000006805.1_ASM680v1_genomic.fna:>NC_002608.1 Halobacterium salinarum NRC-1 plasmid pNRC200, complete sequence
archaea/GCF_000007005.1_ASM700v1_genomic.fna:>NC_002754.1 Saccharolobus solfataricus P2, complete sequence

$ src/data_analysis/extract_ids.R data/chopped/ids.txt -o data/chopped
Done. Wrote file to 'data/chopped/extracted_ids.csv'

$ head -n data/chopped/extracted_ids.csv
"kingdom","accesssion","seq_id"
"archaea","GCF_000006175.1","NC_014222.1"
"archaea","GCF_000006805.1","NC_002607.1"
"archaea","GCF_000006805.1","NC_001869.1"
"archaea","GCF_000006805.1","NC_002608.1"
```
