configfile: "config/config.yaml"

def get_archaea_genomes(wildcards):
	return config["archaea"][wildcards.base]

def get_bacteria_genomes(wildcards):
	return config["bacteria"][wildcards.base]

def get_fungi_genomes(wildcards):
	return config["fungi"][wildcards.base]

def get_viral_genomes(wildcards):
	return config["viral"][wildcards.base] 

rule all:
	input:
		expand("../../data/chopped/archaea/{length}/{archaea}_frags.fasta", length=config["lengths"], archaea=config["archaea"]),
		expand("../../data/chopped/archaea/{length}/{archaea}_frags.tsv", length=config["lengths"], genome=config["archaea"])

rule chop_archaea:
	input:
		get_archaea_genomes
	output:
		fasta="../../data/chopped/archaea/{length}/{base}_frags.fasta",
		tsv="../../data/chopped/archaea/{length}/{base}_frags.tsv"
	params:
		chopper=config["chopper"],
	shell:
		"""
		source ~/.bashrc
		conda activate genome_chopper_env
		
		{params.chopper} -l {wildcards.length} -v 0 -o ../../data/chopped/archaea/{wildcards.length} {input}
		"""

rule chop_bacteria:
