configfile: "config/config.yaml"

def get_input_genomes(wildcards):
	return config["genomes"][wildcards.base]

rule all:
	input:
		expand("out/{length}/{genome}_frags.fasta", length=config["lengths"], genome=config["genomes"]),
		expand("out/{length}/{genome}_frags.tsv", length=config["lengths"], genome=config["genomes"])

rule chop:
	input:
		get_input_genomes
	output:
		fasta="out/{length}/{base}_frags.fasta",
		tsv="out/{length}/{base}_frags.tsv"
	params:
		chopper=config["chopper"],
	shell:
		"""
		source ~/.bashrc
		conda activate genome_chopper_env
		
		{params.chopper} -l {wildcards.length} -v 0 -o out/{wildcards.length} {input}
		"""
